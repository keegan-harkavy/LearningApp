{% extends "intro_flow_2.html" %}
{% block title %}Home{% endblock %}
{% block content %}

<html>
<head>
    <title>Meet George</title>

    <style>
        .container {
            position: center;
            display: inline-block;
        }
        .text-box {
            position: absolute;
            background-color: white;
            border: 1px solid #ccc;
            border-radius: 5px;
            padding: 10px;
            display: block;
            z-index: 1;
        }
        .image-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            justify-content: space-around;
        }
        .image {
            width: 200px; /* Adjust the width of the images */
            height: auto; /* Maintain aspect ratio */
            border: 2px solid transparent; /* Initially no border */
            cursor: pointer; /* Change cursor to pointer */
            transition: border 0.3s; /* Add a smooth transition effect */
        }
        .selected {
            border: 2px solid blue; /* Highlight color for selected images */
        }
        .text {
            text-align: center;
            margin-top: 20px;
        }
        #shuffleButton {
            margin-top: 10px;
            padding: 5px 10px;
            cursor: pointer;
        }
    </style>
</head>
<body>

    <div>
        <div>
            <!-- Introduction text -->
            <p class='text'>
                Now it's time to teach George! To begin, George will ask how to pronounce a sound, and it is up to you to pick the 
                image that corresponds to that sound. 
            </p>
            <button class="microphone-button" type="submit" onclick="toggleAudio()">
                <i class="fas fa-microphone"></i> <!-- Font Awesome volume button icon -->
            </button>  
        </div>

        <!-- Image with text box -->
        <div class="container">
            <!-- Image selection form -->
            <div class="image-grid">
                <form id="imageForm" action="/check" method="post">
                    <div class="image-row">
                        {% for image in existing_images %}
                            <label>
                                <input type="checkbox" name="selected_image" value="{{ i }}" style="display: none;">
                                <img class="image" src="{{ url_for('static', filename=id+'_' + image + '.png') }}" alt="{{ i }}" width="200" height="200">
                            </label>
                        {% endfor %}
                    </div>
                    <button id="submitButton" class="btn btn-primary" type="submit" disabled style="margin-left: 10px;">Submit</button>
                </form>
                <div class='right'>
                    <img src="{{ url_for('static', filename='George.jpg') }}" alt="Your Image">
                    <div class="text-box">
                        <!-- Dynamic letter -->
                        <p>How do you say /<span id="dynamicLetter">sh</span>/?</p>
                        <!-- Shuffle button -->
                        <button id="shuffleButton" class="btn btn-primary">Shuffle Letters</button>
                    </div>
                </div>
            </div>
        </div>

       <audio id="shuffleSound" src="{{ url_for('static', filename='sounds/shuffle_sound.mp3') }}"></audio>

<script>
    var audio = new Audio("{{ url_for('static', filename='/sounds/7_sound.mp3') }}");
    document.addEventListener('DOMContentLoaded', function () {
        const images = document.querySelectorAll('.image');
        const submitButton = document.getElementById('submitButton');
        const shuffleButton = document.getElementById('shuffleButton');
        const dynamicLetter = document.getElementById('dynamicLetter');
        const shuffleSound = document.getElementById('shuffleSound'); // New audio element

        images.forEach(image => {
            image.addEventListener('click', function () {
                images.forEach(img => img.classList.remove('selected'));
                this.classList.add('selected');
                submitButton.disabled = false;
            });
        });

shuffleButton.addEventListener('click', function () {
    const letters = ['sh', 'i', 'p', 'b']; // Add more letters as needed
    const randomLetter = letters[Math.floor(Math.random() * letters.length)];
    dynamicLetter.textContent = randomLetter;
    playSounds(randomLetter); // Play the sound for the shuffled letter
    playShuffleSound(); // Corrected the function call
});


        submitButton.addEventListener('click', function (event) {
            event.preventDefault();
            const selectedImage = document.querySelector('.selected');
            if (selectedImage.src.includes(dynamicLetter.textContent)) {
                alert('Correct image selected!');
                // Use fetch to send data to the server here
            } else {
                alert('Incorrect image selected. Please try again!');
                // Handle the incorrect selection here
            }
        });

function playSounds(sound_1) {
    sound_1 = sound_1 !== undefined && sound_1 !== null ? sound_1 : 'sh';
    var audio = document.getElementById('shuffleSound'); // Corrected the ID
    audio.src = "/static/sounds/" + sound_1 + "_sound.mp3";
    audio.play();
}

    });
    function playShuffleSound() {
    shuffleSound.play();
}
</script>
    </div>
</body>
</html>

{% endblock %}